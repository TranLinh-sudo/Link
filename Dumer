--[[ 
    VISUAL SOURCE DUMPER - HIỆN CODE LÊN MÀN HÌNH
    Khắc phục lỗi không tìm thấy file trên Android
]]

local SearchKey = "2YCGftRB" -- Mã Discord của Teddy Hub

-- TẠO GIAO DIỆN KẾT QUẢ
local function ShowResult(code, path)
    local CoreGui = game:GetService("CoreGui")
    local ScreenGui = Instance.new("ScreenGui")
    local MainFrame = Instance.new("Frame")
    local Title = Instance.new("TextLabel")
    local CodeBox = Instance.new("TextBox") -- Hộp chứa code
    local CopyBtn = Instance.new("TextButton")
    local CloseBtn = Instance.new("TextButton")
    local UICorner = Instance.new("UICorner")

    ScreenGui.Name = "VisualDumper"
    ScreenGui.Parent = CoreGui

    -- Khung chính
    MainFrame.Name = "MainFrame"
    MainFrame.Parent = ScreenGui
    MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    MainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
    MainFrame.Size = UDim2.new(0.8, 0, 0.8, 0) -- To gần hết màn hình
    MainFrame.BorderSizePixel = 2
    MainFrame.BorderColor3 = Color3.fromRGB(0, 255, 100)

    -- Tiêu đề
    Title.Parent = MainFrame
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.BackgroundColor3 = Color3.fromRGB(0, 255, 100)
    Title.TextColor3 = Color3.new(0,0,0)
    Title.Font = Enum.Font.SourceSansBold
    Title.TextSize = 18
    Title.Text = "  ĐÃ TÌM THẤY! (" .. path .. ")"
    Title.TextXAlignment = Enum.TextXAlignment.Left

    -- Hộp chứa Code (Quan trọng nhất)
    CodeBox.Parent = MainFrame
    CodeBox.Position = UDim2.new(0, 10, 0, 50)
    CodeBox.Size = UDim2.new(1, -20, 1, -100)
    CodeBox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    CodeBox.TextColor3 = Color3.fromRGB(200, 200, 200)
    CodeBox.Font = Enum.Font.Code
    CodeBox.TextSize = 14
    CodeBox.TextXAlignment = Enum.TextXAlignment.Left
    CodeBox.TextYAlignment = Enum.TextYAlignment.Top
    CodeBox.Text = code -- Dán code vào đây
    CodeBox.ClearTextOnFocus = false
    CodeBox.MultiLine = true
    CodeBox.TextEditable = false -- Chỉ đọc

    -- Nút Copy
    CopyBtn.Parent = MainFrame
    CopyBtn.Position = UDim2.new(0, 10, 1, -40)
    CopyBtn.Size = UDim2.new(0.4, 0, 0, 30)
    CopyBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    CopyBtn.Text = "COPY TẤT CẢ"
    CopyBtn.TextColor3 = Color3.new(1,1,1)
    CopyBtn.Font = Enum.Font.SourceSansBold
    
    CopyBtn.MouseButton1Click:Connect(function()
        setclipboard(code)
        CopyBtn.Text = "ĐÃ COPY VÀO BỘ NHỚ!"
        wait(2)
        CopyBtn.Text = "COPY TẤT CẢ"
    end)

    -- Nút Đóng
    CloseBtn.Parent = MainFrame
    CloseBtn.Position = UDim2.new(0.5, 10, 1, -40)
    CloseBtn.Size = UDim2.new(0.4, 0, 0, 30)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
    CloseBtn.Text = "ĐÓNG"
    CloseBtn.TextColor3 = Color3.new(1,1,1)
    CloseBtn.Font = Enum.Font.SourceSansBold
    
    CloseBtn.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)
end

-- LOGIC QUÉT
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "VISUAL SCAN",
    Text = "Đang quét...",
    Duration = 3
})

local found = false
local function TryDump(v)
    if v:IsA("LocalScript") or v:IsA("ModuleScript") then
        local s, c = pcall(function() return decompile(v) end)
        if s and string.find(c, SearchKey) then
            -- Hiện bảng kết quả ngay lập tức
            ShowResult(c, v.Name)
            return true
        end
    end
    return false
end

for _, v in pairs(game:GetService("CoreGui"):GetDescendants()) do
    if TryDump(v) then found = true; break end
end

if not found then
    for _, v in pairs(game.Players.LocalPlayer:GetDescendants()) do
        if TryDump(v) then found = true; break end
    end
end

if not found then
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "THẤT BẠI",
        Text = "Không tìm thấy script!",
        Duration = 5
    })
end
