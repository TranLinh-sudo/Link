--[[ 
    MOBILE DUMPER PRO - CÓ THANH TIẾN ĐỘ 
    Dev: Gemini
]]

local SearchKey = "2YCGftRB" -- Từ khóa bí mật cần tìm

-- 1. TẠO GIAO DIỆN (GUI)
local CoreGui = game:GetService("CoreGui")
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local StatusText = Instance.new("TextLabel")
local BarContainer = Instance.new("Frame")
local BarFill = Instance.new("Frame")
local Percentage = Instance.new("TextLabel")
local UICorner = Instance.new("UICorner")

ScreenGui.Name = "DumperGUI"
ScreenGui.Parent = CoreGui

-- Khung chính
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.Position = UDim2.new(0.5, -150, 0.4, 0) -- Căn giữa
MainFrame.Size = UDim2.new(0, 300, 0, 120)
MainFrame.BorderSizePixel = 0

local corner = Instance.new("UICorner", MainFrame)
corner.CornerRadius = UDim.new(0, 8)

-- Tiêu đề
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(255, 170, 0) -- Màu cam
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Font = Enum.Font.SourceSansBold
Title.Text = "  HỆ THỐNG QUÉT SCRIPT"
Title.TextColor3 = Color3.new(1, 1, 1)
Title.TextSize = 16
Title.TextXAlignment = Enum.TextXAlignment.Left
local titleCorner = Instance.new("UICorner", Title)
titleCorner.CornerRadius = UDim.new(0, 8)

-- Chữ trạng thái (Đang quét cái gì...)
StatusText.Parent = MainFrame
StatusText.BackgroundTransparency = 1
StatusText.Position = UDim2.new(0, 10, 0, 35)
StatusText.Size = UDim2.new(1, -20, 0, 20)
StatusText.Font = Enum.Font.Code
StatusText.Text = "Đang khởi tạo..."
StatusText.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusText.TextSize = 12
StatusText.TextXAlignment = Enum.TextXAlignment.Left
StatusText.TextTruncate = Enum.TextTruncate.AtEnd

-- Khung thanh tiến độ
BarContainer.Parent = MainFrame
BarContainer.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
BarContainer.Position = UDim2.new(0, 10, 0, 65)
BarContainer.Size = UDim2.new(1, -20, 0, 20)
local barCorner = Instance.new("UICorner", BarContainer)
barCorner.CornerRadius = UDim.new(0, 4)

-- Thanh chạy (Fill)
BarFill.Parent = BarContainer
BarFill.BackgroundColor3 = Color3.fromRGB(0, 255, 100) -- Màu xanh lá
BarFill.Size = UDim2.new(0, 0, 1, 0) -- Bắt đầu từ 0
local fillCorner = Instance.new("UICorner", BarFill)
fillCorner.CornerRadius = UDim.new(0, 4)

-- Số %
Percentage.Parent = BarContainer
Percentage.BackgroundTransparency = 1
Percentage.Size = UDim2.new(1, 0, 1, 0)
Percentage.Font = Enum.Font.SourceSansBold
Percentage.Text = "0%"
Percentage.TextColor3 = Color3.new(1, 1, 1)
Percentage.TextSize = 14

-- 2. CHỨC NĂNG XỬ LÝ
local function UpdateBar(current, total, scriptName)
    local percent = math.clamp(current / total, 0, 1)
    BarFill:TweenSize(UDim2.new(percent, 0, 1, 0), "Out", "Quad", 0.1)
    Percentage.Text = math.floor(percent * 100) .. "%"
    StatusText.Text = "Scanning: " .. scriptName
end

local function SaveToFile(content)
    local fileName = "TEDDY_HUB_SOURCE.txt"
    writefile(fileName, content)
    
    -- Đổi màu bảng thành xanh dương báo thành công
    Title.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    Title.Text = "  ✅ QUÉT THÀNH CÔNG!"
    StatusText.Text = "Đã lưu vào file: " .. fileName
    BarFill.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    
    wait(3)
    ScreenGui:Destroy()
end

-- 3. BẮT ĐẦU LOGIC QUÉT
task.spawn(function()
    wait(1) -- Chờ UI hiện lên hẳn
    
    -- Bước 1: Thu thập danh sách script trước
    StatusText.Text = "Đang đếm số lượng script..."
    local scriptList = {}
    
    for _, v in pairs(game:GetService("CoreGui"):GetDescendants()) do
        if v:IsA("LocalScript") or v:IsA("ModuleScript") then
            table.insert(scriptList, v)
        end
    end
    for _, v in pairs(game.Players.LocalPlayer:GetDescendants()) do
        if v:IsA("LocalScript") or v:IsA("ModuleScript") then
            table.insert(scriptList, v)
        end
    end
    
    -- Bước 2: Bắt đầu quét từng cái
    local totalScripts = #scriptList
    local found = false
    
    for i, v in ipairs(scriptList) do
        -- Cập nhật thanh tiến độ
        UpdateBar(i, totalScripts, v.Name)
        
        -- Decompile và kiểm tra
        if decompile then
            local success, code = pcall(function() return decompile(v) end)
            if success and string.find(code, SearchKey) then
                -- BẮT ĐƯỢC RỒI!
                UpdateBar(totalScripts, totalScripts, "FOUND!")
                SaveToFile(code)
                found = true
                break
            end
        end
        
        -- Nghỉ cực ngắn để UI không bị đơ
        if i % 5 == 0 then task.wait() end 
    end
    
    if not found then
        Title.BackgroundColor3 = Color3.fromRGB(255, 50, 50) -- Màu đỏ
        Title.Text = "  ❌ THẤT BẠI"
        StatusText.Text = "Không tìm thấy script nào!"
        wait(3)
        ScreenGui:Destroy()
    end
end)
