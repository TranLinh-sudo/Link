--[[ UNIVERSAL SOURCE DUMPER - PHIÊN BẢN TEDDY ]]

-- /// CẤU HÌNH QUAN TRỌNG ///
getgenv().TargetNameKeyword = "Teddy" -- Đã đổi thành Teddy để bắt đúng script

local function SaveSource(name, content)
    if not content or content == "" then return end
    -- Tạo tên file có chữ DUMP để dễ tìm
    local fileName = "DUMP_" .. name .. ".txt"
    
    writefile(fileName, content)
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "ĐÃ BẮT ĐƯỢC!",
        Text = "Đã lưu file: " .. fileName,
        Duration = 5
    })
    print("\n[SUCCESS] Đã in mã nguồn: " .. fileName)
end

if not decompile then
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "LỖI",
        Text = "Executor yếu quá, không in được!",
        Duration = 5
    })
else
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "ĐANG QUÉT...",
        Text = "Đang tìm script tên 'Teddy'...",
        Duration = 3
    })
    
    local found = false
    -- Quét CoreGui
    for _, v in pairs(game:GetService("CoreGui"):GetDescendants()) do
        if (v:IsA("LocalScript") or v:IsA("ModuleScript")) and string.find(v.Name, getgenv().TargetNameKeyword) then
            found = true
            local s, c = pcall(function() return decompile(v) end)
            if s then SaveSource(v.Name, c) end
        end
    end
    
    -- Quét thêm trong Player (Đề phòng nó giấu trong nhân vật)
    for _, v in pairs(game.Players.LocalPlayer:GetDescendants()) do
        if (v:IsA("LocalScript") or v:IsA("ModuleScript")) and string.find(v.Name, getgenv().TargetNameKeyword) then
            found = true
            local s, c = pcall(function() return decompile(v) end)
            if s then SaveSource(v.Name, c) end
        end
    end

    if not found then
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "KHÔNG TÌM THẤY",
            Text = "Không thấy script nào tên là Teddy cả!",
            Duration = 5
        })
    end
end

